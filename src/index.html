<!DOCTYPE html>
<html lang="en">
<head>
    <title>Dynamic Calendar</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body 
        {
            background-color: #333;
        }
    </style>

</head>
<body>
    <div id="calendar">
        <div id="calendar-header">
            <div id="calendarHeader"></div>
            <button class='calendar-btn' id="prev">&lt;</button>
            <button class='calendar-btn' id="current">today</button>
            <button class='calendar-btn' id="next">&gt;</button>
        </div>
        <div id="mainContent"></div>
        <div id="agendaDisplay"></div>
    </div>
    <script>
        let _currentDate = new Date();
        let _currentMonth = _currentDate.getMonth();
        let _currentYear = _currentDate.getFullYear();
        const _todaysDate = new Date();
        const _buttonPreviousMonth = document.getElementById('prev');
        const _buttonNextMonth = document.getElementById('next');
        const _buttonThisMonth = document.getElementById('current');
        const _agendaRenderContainer = document.getElementById('agendaDisplay');
        const _calendarRenderContainer = document.getElementById('mainContent');
        const _daysOfTheWeek = ( 
                    ["Sun",
                    "Mon",
                    "Tue", 
                    "Wed", 
                    "Thu",
                    "Fri", 
                    "Sat"
                    ]);
        const _monthsOfTheYear = (
                    ["January", 
                    "February", 
                    "March", 
                    "April", 
                    "May", 
                    "June",
                    "July", 
                    "August", 
                    "September", 
                    "October",
                    "November", 
                    "December"
                    ]);
                
        
        // calculates the number of days in a given month of a year
        function daysInCalendarMonth(pYear, pMonth)
		{
			return new Date(pYear, pMonth + 1, 0).getDate();
		}

        function generateCalendar(pCurrentYear, pCurrentMonth)
        {
            let tmpTable = "<table class='calendar-table'>";
            tmpTable += "<tr>";
            for ( i = 0; i < 7; i++)
            {
                tmpTable += "<th class='day'>" + _daysOfTheWeek[i] + "</th>";
            }
            tmpTable += "</tr>";
            // get the number of weeks in the current month 
            let tmpNumberOfDaysInTheMonth = daysInCalendarMonth(pCurrentYear, pCurrentMonth);
            let tmpNumberOfDaysInLastMonth = daysInCalendarMonth(pCurrentYear, pCurrentMonth - 1)
            let tmpNumberOfWeeksInCurrentMonth = Math.ceil(tmpNumberOfDaysInTheMonth / 7);
            let tmpNumberOfDaysToRender = tmpNumberOfWeeksInCurrentMonth * 7;
            let tmpFirstDayOfTheCurrentMonth = new Date(pCurrentYear, pCurrentMonth, 1);
            let tmpWeekDayIndexOfTheFirstDayOfTheCurrentMonth = tmpFirstDayOfTheCurrentMonth.getDay();
            let tmpCurrentlyRenderingDayOfThisMonth = 1;
            let tmpCurrentlyRenderingDayOfNextMonth = 1;
            let tmpCurrentlyRenderingDayOfLastMonth = tmpNumberOfDaysInLastMonth - tmpWeekDayIndexOfTheFirstDayOfTheCurrentMonth + 1;

            if ( tmpWeekDayIndexOfTheFirstDayOfTheCurrentMonth > 4)
            {
                tmpNumberOfDaysToRender += 7;
            }
            for ( i = 0; i < tmpNumberOfDaysToRender; i++)
            {
                // this is which week of the month we are on starting at 0
                let tmpWeekIndex = Math.floor(i / 7);
                // this is whether it's day 0 to day 6 as displayed on the calendar
                let tmpWeekDayIndex = i % 7;

                if ( tmpWeekDayIndex == 0)
                {
                    tmpTable += "<tr>";
                }
                // first week of the month
                if ( tmpWeekIndex == 0)
                {
                    // if it's before the first day of this month
                    if ( tmpWeekDayIndex < tmpWeekDayIndexOfTheFirstDayOfTheCurrentMonth)
                    {
                        tmpTable += "<td><div class='day lastMonth'>" + tmpCurrentlyRenderingDayOfLastMonth + "</div></td>";
                        tmpCurrentlyRenderingDayOfLastMonth++;
                    }
                    else
                    {
                        tmpTable += "<td><div class='day thisMonth'>" + tmpCurrentlyRenderingDayOfThisMonth + "</div></td>";
                        tmpCurrentlyRenderingDayOfThisMonth++;
                    }
                }
                // any other week of the month
                else
                {
                    if ( tmpCurrentlyRenderingDayOfThisMonth <= tmpNumberOfDaysInTheMonth)
                    {
                        tmpTable += "<td><div class='day thisMonth'>" + tmpCurrentlyRenderingDayOfThisMonth + "</div></td>";
                        tmpCurrentlyRenderingDayOfThisMonth++;
                    }
                    else
                    {
                        tmpTable += "<td><div class='day nextMonth'>" + tmpCurrentlyRenderingDayOfNextMonth + "</div></td>";
                        tmpCurrentlyRenderingDayOfNextMonth++;
                    }
                }
                // if it's the last rendered day of the week
                if ( tmpWeekDayIndex == 6)
                {
                    tmpTable += "</tr>";
                }
            }
                tmpTable += "</table>";
                _calendarRenderContainer.innerHTML = tmpTable;
                document.getElementById("calendarHeader").innerHTML = "<h1 class='dateHeader'>" + _monthsOfTheYear[pCurrentMonth] + " " + pCurrentYear + "</h1>";
        }

        // function to generate agenda for the day selected
        function generateAgenda(pCurrentYear, pCurrentMonth, pCurrentDay)
        {
            let tmpAgendaHeader = "<h1 class='agendaHeader'>" + pCurrentMonth + pCurrentDay + ", " + pCurrentYear + "</h1>";
            let tmpAgenda = "<table class='agenda'>";
            let tmpAgendaRowIndex = 10;
            
            for (i = 0; i < tmpAgendaRowIndex; i++)
            {
                tmpAgenda += "<tr>" + "<td>" + " " + "</td>" + "</tr>";
            }
            
        }  

        // setting buttons to call toPreviousMonth and toNextMonth respectively on click
        _buttonPreviousMonth.addEventListener('click', toPreviousMonth);
        _buttonNextMonth.addEventListener('click', toNextMonth);
        _buttonThisMonth.addEventListener('click', toCurrentMonth);

        // renders previous month
        function toPreviousMonth()
        {
                if (_currentMonth == 0)
                {
                    _currentYear--;
                    _currentMonth = 11;
                }
                else
                {
                    _currentMonth--;
                }
                generateCalendar(_currentYear, _currentMonth);
                return true;
        }

        // renders next month
        function toNextMonth()
        {
                if (_currentMonth == 11)
                {
                    _currentYear++;
                    _currentMonth = 0;
                }
                else
                {
                    _currentMonth++;
                }
                generateCalendar(_currentYear, _currentMonth);
                return true;
        }

        // renders current month
        function toCurrentMonth()
        {

            generateCalendar(_todaysDate.getFullYear(), _todaysDate.getMonth());
            return true;
        }

        generateCalendar(_currentYear, _currentMonth);
        generateAgenda(_currentYear, _currentMonth, _currentDate);
    </script>
</body>
</html>